+++
title = "Docker. Основные понятия и примеры."
//TODO
date = ""
categories = [
    "DevOps"
]
tags = [ 
    "docker"
]
draft = true
+++

Docker - это платформа для разработчиков и системных администраторов, целью которой является **разработка**, **развертываение** и **запуск приложений** приложений с контейнерами. Вроде как считается, что Docker это такая облегченная виртуальная машина, но это не так. Запущенные контейнеры резделяют ресурсы ядра *linux* хост системы(на которой запущено сама аппликуха *docker*) и других контейнеров. Эта технология предоставляет некоторые плюсы:

- гибкая и простая сборка и запуск артефактов контейнера с приложением и дальнейшая загрузка на сервер;
- воспроизведение необходимой для работы преложения среды (библиотеки, конкретная версия виртуальной машины и другие зависиомости);
- удобное место для провередния экспериментов как на локальной так и на удаленной машине.

Основная задача статьи это не полный образ всех средст и возможностей *docker*, а общее ознакомление с экосистемой и примеры упаковки приложений в образы с последующим запуском. В качестве примеров(один из разделов статьи) будут использованы несколько приложений на *java* и *go*.

План статьи следующий:
- рассматриваем основные понятия;
- устанавливаем *docker* локально и/или на виртуалке одного из облачных провайдеров;
- запускаем первый контейнер;
- изучаем основные команды;
- разбираемся с понятием сетей в *docker*;
- читаем про *docker volumes*;
- пробуем *docker-compose*;
- запускаем несколько приложений в контейнерах.

## Основные понятия

В основе работы всей экосистемы лежат следующие функции ядра **linux**: [namespaces](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%81%D1%82%D1%80%D0%B0%D0%BD%D1%81%D1%82%D0%B2%D0%BE_%D0%B8%D0%BC%D1%91%D0%BD_(Linux)) и [cgroups](https://ru.wikipedia.org/wiki/Cgroups#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5), про которые отлично описано в статьях [раз](https://habrahabr.ru/company/selectel/blog/279281/) и [два](https://habrahabr.ru/company/selectel/blog/303190/). 

Основные понятия в *Docker* это *контейнер (container)* и *образ (image)*. Тут применимы следующие описания:

- образ это исполняемый пакет, который включает в себя все необходимое для запуска приложения: код, среду выполнения, библиотеки, переменные среды и файлы конфигурации(при необходимости);
- контейнер запускается используя образ;
- образа собираются, а контейнеры запускаются;
- контейнер это экземпляр среды исполнения образа.

### Файл описания образа

Для сборки образа необходимо описать так называемый `Dockerfile`, содержащий команды, последовательное выполнение которых и представляет из себя образ. Без него не получится упаковать свое приложение и запустить его в контейнере, более подробно про *Dockerfile* описано на соответствующей [странице](https://docs.docker.com/engine/reference/builder/). В статье если это не предзагруженный 


## Установка

Установка *docker* под *linux*, *macOS* и *windows* отличается. Подробное описание этого можно найти на соответствующей [странице](https://docs.docker.com/install/).

Простой способ установить докер на удаленную машину, это не устанавливаеть его, например в [DO](https://www.digitalocean.com/) можно сразу же создать *droplet* с предустановленным докером. Но для создания *docker swarm* кластера это не подходит, есть [проблемка](https://stackoverflow.com/a/48960753) и у меня на даннымй момент она воспроизводится. Поэтому просто создаем *droplet* с *Ubuntu* и устанавливаем *docker* используя [скрипт](https://get.docker.com/) для быстрой установки(инструкция внутри). 

## Основные команды

docker build --rm -f Dockerfile -t 'translator:latest' . 

docker run --rm -p 8080:8080 'translator' 

docker rm $(docker ps -a -q)

docker rmi $(docker images -q -a)

docker exec -it heuristic_mccarthy /bin/bash


